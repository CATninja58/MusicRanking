<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>View My Rankings</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    body { font-family: Arial; padding: 20px; background: #f7f7f7; }
    h1 { margin-bottom: 10px; }
    select, button { margin: 10px 0; }
    .album, .song {
      display: flex;
      align-items: center;
      margin: 8px 0;
      background: #fff;
      border-radius: 6px;
      padding: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .album img, .song img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 5px;
      margin-right: 15px;
    }
    .ranking-info {
      display: flex;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <h1>My Rankings</h1>
  <select id="rankingCategory">
    <option value="albums">Album Rankings</option>
    <option value="songs">Song Rankings</option>
    <option value="perfectAlbums">Perfect Albums (9–10/10)</option>
    <option value="perfectSongs">Perfect Songs (9–10/10)</option>
  </select>

  <button onclick="toggleSort()">Toggle Sort Order</button>
  <div id="rankingList"></div>

  <script>
    let sortDescending = true;

    function toggleSort() {
      sortDescending = !sortDescending;
      renderRankings();
    }

    function renderRankings() {
      const category = document.getElementById('rankingCategory').value;
      const container = document.getElementById('rankingList');
      container.innerHTML = '';

      const rankings = JSON.parse(localStorage.getItem('rankings') || '{}');
      const albums = rankings.albums || {};
      const songs = rankings.songs || {};

      if (category === 'albums' || category === 'perfectAlbums') {
        const albumEntries = Object.entries(albums)
          .filter(([, data]) => category !== 'perfectAlbums' || data.rating >= 9)
          .sort((a, b) => sortDescending ? b[1].rating - a[1].rating : a[1].rating - b[1].rating);

        albumEntries.forEach(([id, data]) => {
          const div = document.createElement('div');
          div.className = 'album';
          div.innerHTML = `
            <img src="${data.cover}" alt="${data.name}" />
            <div class="ranking-info">
              <strong>${data.name}</strong>
              <span>Rating: ${data.rating}/10</span>
            </div>
          `;
          container.appendChild(div);
        });
      }

      if (category === 'songs' || category === 'perfectSongs') {
        const songEntries = Object.entries(songs)
          .flatMap(([albumName, songList]) =>
            Object.entries(songList).map(([songTitle, rating]) => ({
              albumName,
              songTitle,
              rating
            }))
          )
          .filter(entry => category !== 'perfectSongs' || entry.rating >= 9)
          .sort((a, b) => sortDescending ? b.rating - a.rating : a.rating - b.rating);

        songEntries.forEach(({ albumName, songTitle, rating }) => {
          const div = document.createElement('div');
          div.className = 'song';
          div.innerHTML = `
            <img src="https://via.placeholder.com/60?text=♪" alt="Song" />
            <div class="ranking-info">
              <strong>${songTitle}</strong>
              <span>Album: ${albumName}</span>
              <span>Rating: ${rating}/10</span>
            </div>
          `;
          container.appendChild(div);
        });
      }
    }

    document.getElementById('rankingCategory').addEventListener('change', renderRankings);
    renderRankings();
  </script>
</body>
</html>
