<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tier List</title>
    <style>
        /* Basic styling */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .tier-list {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .tier {
            width: 20%;
            min-height: 150px;
            border: 1px solid #ccc;
            background-color: #fff;
            padding: 10px;
            overflow-y: auto;
        }
        .tier h2 {
            text-align: center;
        }
        .album-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .album {
            width: 120px;
            height: 120px;
            cursor: pointer;
            position: relative;
        }
        .album img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .album:hover .album-title {
            display: block;
        }
        .album-title {
            display: none;
            position: absolute;
            bottom: 5px;
            left: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
        }
        #albumSongs, #allSongs {
            display: none;
        }
        .song-list {
            list-style-type: none;
            padding: 0;
        }
        .song-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 5px 0;
        }
        .song-item img {
            width: 30px;
            height: 30px;
            object-fit: cover;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <h1>Tier List for <span id="artistName"></span></h1>

    <div class="tier-list">
        <div class="tier" id="tierAlbum">Albums</div>
        <div class="tier" id="tierAlbumSongs">Album Songs</div>
        <div class="tier" id="tierAllSongs">All Songs</div>
    </div>

    <div id="albumList" class="album-list"></div>

    <div id="albumSongs">
        <h3>Select an album to rank songs</h3>
        <ul id="albumSongList" class="song-list"></ul>
    </div>

    <div id="allSongs">
        <h3>All Songs</h3>
        <input type="text" id="songSearch" placeholder="Search songs..." />
        <ul id="songList" class="song-list"></ul>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const artistData = JSON.parse(localStorage.getItem("currentArtistData"));
            if (!artistData) {
                alert("No artist data found. Please go back and select an artist.");
                return;
            }

            const artistName = document.getElementById("artistName");
            const albumList = document.getElementById("albumList");
            const albumSongs = document.getElementById("albumSongs");
            const albumSongList = document.getElementById("albumSongList");
            const allSongs = document.getElementById("allSongs");
            const songList = document.getElementById("songList");
            const songSearch = document.getElementById("songSearch");

            artistName.textContent = artistData.name;

            // Populate album list
            artistData.albums.forEach((album, index) => {
                const albumDiv = document.createElement("div");
                albumDiv.classList.add("album");
                albumDiv.innerHTML = `<img src="${album.cover}" alt="${album.name}" /> 
                                      <div class="album-title">${album.name}</div>`;
                albumDiv.onclick = () => loadAlbumSongs(album);
                albumList.appendChild(albumDiv);
            });

            // Handle tier selection
            document.getElementById("tierAlbum").onclick = () => displayAlbums();
            document.getElementById("tierAlbumSongs").onclick = () => displayAlbumSongs();
            document.getElementById("tierAllSongs").onclick = () => displayAllSongs();

            // Display albums by default
            displayAlbums();

            function displayAlbums() {
                albumList.style.display = "flex";
                albumSongs.style.display = "none";
                allSongs.style.display = "none";
            }

            function displayAlbumSongs() {
                albumList.style.display = "none";
                albumSongs.style.display = "block";
                allSongs.style.display = "none";
            }

            function displayAllSongs() {
                albumList.style.display = "none";
                albumSongs.style.display = "none";
                allSongs.style.display = "block";

                const allSongsList = artistData.albums.flatMap(album => album.songs);
                songList.innerHTML = "";
                allSongsList.forEach(song => {
                    const li = document.createElement("li");
                    li.classList.add("song-item");
                    li.innerHTML = `<img src="${song.album.cover}" alt="${song.name}" />
                                    <span>${song.name}</span>
                                    <input type="number" min="1" max="10" data-song="${song.name}" class="rating-input" />`;
                    songList.appendChild(li);
                });
            }

            function loadAlbumSongs(album) {
                albumSongList.innerHTML = "";
                album.songs.forEach(song => {
                    const li = document.createElement("li");
                    li.classList.add("song-item");
                    li.innerHTML = `<span>${song.name}</span>
                                    <input type="number" min="1" max="10" data-song="${song.name}" class="rating-input" />`;
                    albumSongList.appendChild(li);
                });
                displayAlbumSongs();
            }
        });
    </script>
</body>
</html>
